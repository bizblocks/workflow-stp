# Обзор

Данный модуль для CUBA приложений предоставляет дополнительный функционал по реализации сложных рабочих процессов декларативным путем
любых сущностей в системе (заявки, задачи и др.) для которых необходимо как последовательное выполнение определенных действий так и глубокое
взаимодействие с пользователями на различных этапах.

# Начало работы

## Установка Workflow-STP Add-on

Для того, чтобы у пользователя появилась возможность использовать add-on в CUBA.platform приложении
необходимо произвести установку add-on в локальный репозиторий пользователя. Рекомендуется делать эту
процедуру в Cuba Studio, для этого импортируйте add-on в Cuba Studio и выполните `Run` -> `Install app component`.

## Подключение Workflow-STP Add-on в CUBA.platform App

Данную операцию рекомендуется выполнять в Cuba Studio. Откройте проект в Cuba Studio и
перейдите к редактированию его своств (`Project properties` -> `Edit`). Нажмите на `+` расположенный
рядом с надписью `Custom components`. В выподающем спике (второе поле) должен быть доступен компонент
с именем `workflow-stp` (в случае если вы выполнили его установку ранее). Выберите компонент, нажмите `ok`,
сохраните настройки проекта. Workflow-STP Add-on подключен.

## Описание предметной модели
Описание рабочего процесса состоит из нескольких основных и простых частей. Опишем каждую из них.

### Обрабатываемая сущность (WorkflowEntity)
Под обрабатываемой сущностью подразумевается любая сущность в системе для которой необходимо реализовать рабочий процесс обработки. Сущность должна наследоваться от специального интерфейса:
```
com.groupstp.workflowstp.entity.WorkflowEntity
```
Которая предоставляет возможность сохранять связь с процессами, помечать текущий статус, а так же прослеживать прогресс обработки.

### Рабочий процесс (Workflow)
Под рабочим процессом понимается совокупность заранее определенных шагов и направлений обработки. Иными словами рабочий процесс - это шаблон, описание, по тому как необходимо производить обработку.

* __Название(name):__ Название для быстрой идентификации пользователями.

* __Код (code):__ Машинный шифр для идентификации рабочего процесса системой.

* __Активен (active):__ Флажок означающий что рабочий процесс готов и может быть применен в работу.

* __Название применяемой сущности (entityName):__ Именование сущности для которой описан данный рабочий процесс.

* __Шаги (steps):__ Список определенных в рабочем процессе шагов.

* __Порядок (order):__ Общий порядок рабочего процесса в списке всех рабочих процессов.

### Этап (Stage)
Под этапом подразумевается некое абстрактное атомарное состояние процесса обработки. Каждый этап можно разделить на определенный тип, определить действия, поведение и т.д.

* __Название(name):__ Название для быстрой идентификации пользователями.

* __Название применяемой сущности (entityName):__ Именование сущности для которой описан данный этап.

* __Тип этапа (type):__ Тип этапа. Возможные значения:
** __Взаимодействие с пользователями (USERS_INTERACTION)__ - когда ожидается некоторые действия от пользователей в системе
** __Архив(ARCHIVE)__ - состояние, которое не требует непосредственного взаимодействия от пользователей, однако помечает рабочий процесс как завершенный предоставляет возможность постоянного просмотра
** __Выполнение алгоритма(ALGORITHM_EXECUTION)__ - этап подразумевает выполнение системы некоторой последовательности команд.

* __Участники (actors):__ В случае с типом USERS_INTERACTION можно указать конкретных пользователей, от которых ожидается действие.

* __Участники по ролям (actorsRoles):__ В случае с типом USERS_INTERACTION можно указать конкретные роли пользователей, от которых ожидается действие.
И если пользователь обладает хоть одной ролью из перечисленных, он является полноправным участником данного этапа.

* __Наблюдатели (viewers):__ В случае с типом USERS_INTERACTION можно указать конкретных пользователей, которые имеют возможность взаимодействовать с этапом, но только в режиме просмотра (viewOnly).

* __Наблюдатели по ролям (viewersRoles):__ В случае с типом USERS_INTERACTION можно указать конкретныt роли пользователей, которые имеют возможность взаимодействовать с этапом, но только в режиме просмотра (viewOnly).
И если пользователь обладает хоть одной ролью из перечисленных, он является полноправным наблюдателем данного этапа. В случае если пользователь и наблюдатель и участник - система воспримет его как участника.

* __Набор команд для выполнения (executionGroovyScript):__ В случае с типом ALGORITHM_EXECUTION необходимо предоставить набор команд, которые необходимо выполнить системе.

* __Описание расширения экрана списков (browserScreenConstructor):__ В случае с типом USERS_INTERACTION или ARCHIVE можно декларативно задать главные элементы экрана для страницы со списоком.

* __Описание расширения экрана редактора (editorScreenConstructor):__ В случае с типом USERS_INTERACTION или ARCHIVE можно декларативно задать главные элементы экрана для страницы с редактором.

* __Общее расширение экрана (screenConstructor):__ В случае с типом USERS_INTERACTION или ARCHIVE можно декларативно задать общие элементы экранов как для списков так и для редактора.

* __Переменные направлений (directionVariables):__ Перечисление возможных переменных из этапа, которые будут подчищены при движении по одному из направлений.
